(function(e,r){if(typeof define==="function"&&define.amd){define([],r)}else{e._hyperscript=r()}})(typeof self!=="undefined"?self:this,function(){return function(){"use strict";var v=function(){var k={"+":"PLUS","-":"MINUS","*":"MULTIPLY","/":"DIVIDE",".":"PERIOD","\\":"BACKSLASH",":":"COLON","%":"PERCENT","|":"PIPE","!":"EXCLAMATION","?":"QUESTION","#":"POUND","&":"AMPERSAND",";":"SEMI",",":"COMMA","(":"L_PAREN",")":"R_PAREN","<":"L_ANG",">":"R_ANG","<=":"LTE_ANG",">=":"GTE_ANG","==":"EQ","===":"EQQ","{":"L_BRACE","}":"R_BRACE","[":"L_BRACKET","]":"R_BRACKET","=":"EQUALS"};function x(e){return A(e)||C(e)||e==="-"||e==="_"}function b(e){return A(e)||C(e)||e==="-"||e==="_"||e===":"}function O(e){return e===" "||e==="\t"||L(e)}function R(e){return"[Line: "+e.line+", Column: "+e.col+"]"}function L(e){return e==="\r"||e==="\n"}function C(e){return e>="0"&&e<="9"}function A(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function G(r,t,e){function i(e,r){h.raiseParseError(e,r)}function n(e){var r=s(e);if(r){return r}else{i(this,"Expected '"+e+"' but found '"+f().value+"'")}}function a(e,r,t){for(var n=0;n<arguments.length;n++){var a=arguments[n];var i=s(a);if(i){return i}}}function s(e){if(f()&&f().op&&f().value===e){return m()}}function o(e,r,t,n){var a=l(e,r,t,n);if(a){return a}else{i(this,"Expected one of "+JSON.stringify([e,r,t]))}}function l(e,r,t,n){if(f()&&f().type&&[e,r,t,n].indexOf(f().type)>=0){return m()}}function u(e,r){var t=p(e,r);if(t){return t}else{i(this,"Expected '"+e+"' but found '"+f().value+"'")}}function p(e,r){var r=r||"IDENTIFIER";if(f()&&f().value===e&&f().type===r){return m()}}function m(){var e=r.shift();t.push(e);return e}function c(){return r.length>0}function f(){return r[0]}return{matchAnyOpToken:a,matchOpToken:s,requireOpToken:n,matchTokenType:l,requireTokenType:o,consumeToken:m,matchToken:p,requireToken:u,list:r,source:e,hasMore:c,currentToken:f}}function e(e){var r=e;var t=[];var n=0;var a=0;var i=1;var s="<START>";while(n<r.length){g();if(E()==="-"&&d()==="-"){u()}else{if(!y()&&E()==="."&&A(d())){t.push(p())}else if(!y()&&E()==="#"&&A(d())){t.push(m())}else if(A(E())){t.push(c())}else if(C(E())){t.push(f())}else if(E()==='"'||E()==="'"){t.push(h())}else if(k[E()]){t.push(v())}else{if(n<r.length){throw Error("Unknown token: "+E()+" ")}}}}return G(t,[],r);function o(e,r){var t=l(e,r);t.op=true;return t}function l(e,r){return{type:e,value:r,start:n,end:n+1,column:a,line:i}}function u(){while(E()&&!L(E())){T()}T()}function p(){var e=l("CLASS_REF");var r=T();while(x(E())){r+=T()}e.value=r;e.end=n;return e}function m(){var e=l("ID_REF");var r=T();while(b(E())){r+=T()}e.value=r;e.end=n;return e}function c(){var e=l("IDENTIFIER");var r=T();while(A(E())){r+=T()}e.value=r;e.end=n;return e}function f(){var e=l("NUMBER");var r=T();while(C(E())){r+=T()}if(E()==="."){r+=T()}while(C(E())){r+=T()}e.value=r;e.end=n;return e}function v(){var e=T();while(E()&&k[e+E()]){e+=T()}var r=o(k[e],e);r.value=e;r.end=n;return r}function h(){var e=l("STRING");var r=T();var t="";while(E()&&E()!==r){if(E()==="\\"){T()}t+=T()}if(E()!==r){throw Error("Unterminated string at "+R(e))}else{T()}e.value=t;e.end=n;return e}function E(){return r.charAt(n)}function d(){return r.charAt(n+1)}function T(){s=E();n++;a++;return s}function y(){return A(s)||C(s)||s===")"||s==="}"||s==="]"}function g(){while(E()&&O(E())){if(L(E())){a=0;i++}T()}}}return{tokenize:e}}();var h=function(){var a={};function e(e,r){a[e]=r}function n(e){var r=e.currentToken();var t=e.source;var n=t.split("\n");var a=r?r.line-1:n.length-1;var i=n[a];var s=r?r.column:i.length-1;return i+"\n"+" ".repeat(s)+"^^\n\n"}function r(e,r){r=(r||"Unexpected Token : "+e.currentToken().value)+"\n\n"+n(e);var t=new Error(r);t.tokens=e;throw t}function i(e,r,t){var n=a[e];if(n)return n(h,r,t)}function t(e,r){for(var t=0;t<e.length;t++){var n=e[t];var a=i(n,r);if(a){return a}}}function s(e){return i("hyperscript",e)}function o(e,r){if(e==null){return r}var t=e.transpile();if(e.next){return t+"\n"+o(e.next)}else{return t}}return{parseElement:i,parseAnyOf:t,parseHyperScript:s,raiseParseError:r,addGrammarElement:e,transpile:o}}();var t=function(){var n=["_","script","data-script"];function e(e,r){var t=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;return t&&t.call(e,r)}function i(e,r){var t;if(window.CustomEvent&&typeof window.CustomEvent==="function"){t=new CustomEvent(e,{bubbles:true,cancelable:true,detail:r})}else{t=document.createEvent("CustomEvent");t.initCustomEvent(e,true,true,r)}return t}function r(e,r,t){var t=t||{};t["sentBy"]=e;var n=i(r,t);var a=e.dispatchEvent(n);return a}function t(e,r){if(e.length){for(var t=0;t<e.length;t++){r(e[t])}}else{r(e)}}function s(e){for(var r=0;r<n.length;r++){var t=n[r];if(e.hasAttribute(t)){return e.getAttribute(t)}}return null}function a(e,r){t(e.eventListeners,function(e){e(r)})}function o(e){n=e}function l(){return n.map(function(e){return"["+e+"]"}).join(", ")}function u(e,r){return Object.prototype.toString.call(e)==="[object "+r+"]"}function p(e,r,t){if(u(r,"Object")){var n=e;var a=r;var i="expression"}else if(u(r,"String")){var n=r;var i=e;var a=t}else{var n=e;var a={};var i="expression"}a=a||{};var s=h.parseElement(i,v.tokenize(n)).transpile();var o="(function("+Object.keys(a).join(",")+"){return "+s+"})";if(false)console.log("transpile: "+s);if(false)console.log("evalString: "+o);var l=Object.keys(a).map(function(e){return a[e]});if(false)console.log("args",l);return eval(o).apply(null,l)}function m(e){var r=s(e);if(r){var t=v.tokenize(r);var n=h.parseHyperScript(t);var a=h.transpile(n);if(false)console.log(a);var i=eval(a);i.applyEventListenersTo(e)}}function c(e,r,t,n){var a=new XMLHttpRequest;a.onload=function(){t(this.response)};a.open(e,r);a.send(JSON.stringify(n))}function f(e,r,t){if(e==null&&t){return e}var n=Object.prototype.toString.call(e).slice(8,-1);var a=e&&n===r;if(a){return e}else{throw new Error("Typecheck failed!  Expected: "+r+", Found: "+n)}}return{typeCheck:f,forEach:t,triggerEvent:r,matchesSelector:e,getScript:s,applyEventListeners:a,setScriptAttrs:o,initElement:m,evaluate:p,getScriptSelector:l,ajax:c}}();h.addGrammarElement("parenthesized",function(e,r){if(r.matchOpToken("(")){var t=e.parseElement("expression",r);r.requireOpToken(")");return{type:"parenthesized",expr:t,transpile:function(){return"("+e.transpile(t)+")"}}}});h.addGrammarElement("string",function(e,r){var t=r.matchTokenType("STRING");if(t){return{type:"string",token:t,transpile:function(){if(t.value.indexOf("'")===0){return"'"+t.value+"'"}else{return'"'+t.value+'"'}}}}});h.addGrammarElement("number",function(e,r){var t=r.matchTokenType("NUMBER");if(t){var n=t;var a=parseFloat(t.value);return{type:"number",value:a,numberToken:n,transpile:function(){return n.value}}}});h.addGrammarElement("idRef",function(e,r){var t=r.matchTokenType("ID_REF");if(t){return{type:"idRef",value:t.value.substr(1),transpile:function(){return"document.getElementById('"+this.value+"')"}}}});h.addGrammarElement("classRef",function(e,r){var t=r.matchTokenType("CLASS_REF");if(t){return{type:"classRef",value:t.value,className:function(){return this.value.substr(1)},transpile:function(){return"document.querySelectorAll('"+this.value+"')"}}}});h.addGrammarElement("attributeRef",function(e,r){if(r.matchOpToken("[")){var t=r.matchTokenType("IDENTIFIER");var n=null;if(r.matchOpToken("=")){n=e.parseElement("expression",r)}r.requireOpToken("]");return{type:"attribute_expression",name:t.value,value:n,transpile:function(){if(this.value){return"({name: '"+this.name+"', value: "+e.transpile(this.value)+"})"}else{return"({name: '"+this.name+"'})"}}}}});h.addGrammarElement("objectLiteral",function(r,e){if(e.matchOpToken("{")){var t=[];if(!e.matchOpToken("}")){do{var n=e.requireTokenType("IDENTIFIER");e.requireOpToken(":");var a=r.parseElement("expression",e);t.push({name:n,value:a})}while(e.matchOpToken(","));e.requireOpToken("}")}return{type:"objectLiteral",fields:t,transpile:function(){return"({"+t.map(function(e){return e.name.value+":"+r.transpile(e.value)}).join(", ")+"})"}}}});h.addGrammarElement("symbol",function(e,r){var t=r.matchTokenType("IDENTIFIER");if(t){return{type:"symbol",name:t.value,transpile:function(){return t.value}}}});h.addGrammarElement("implicitMeTarget",function(e,r){return{type:"implicitMeTarget",transpile:function(){return"[me]"}}});h.addGrammarElement("implicitAllTarget",function(e,r){return{type:"implicitAllTarget",transpile:function(){return'document.querySelectorAll("*")'}}});h.addGrammarElement("millisecondLiteral",function(e,r){var t=r.requireTokenType(r,"NUMBER");var n=1;if(r.matchToken("s")){n=1e3}else if(r.matchToken("ms")){}return{type:"millisecondLiteral",number:t,factor:n,transpile:function(){return n*parseFloat(this.number.value)}}});h.addGrammarElement("boolean",function(e,r){var t=r.matchToken("true")||r.matchToken("false");if(t){return{type:"boolean",transpile:function(){return t.value}}}});h.addGrammarElement("null",function(e,r){if(r.matchToken("null")){return{type:"null",transpile:function(){return"null"}}}});h.addGrammarElement("arrayLiteral",function(r,e){if(e.matchOpToken("[")){var t=[];if(!e.matchOpToken("]")){do{var n=r.parseElement("expression",e);if(n==null){r.raiseParseError(e,"Expected an expression")}t.push(n)}while(e.matchOpToken(","));e.requireOpToken("]")}return{type:"arrayLiteral",values:t,transpile:function(){return"["+t.map(function(e){return r.transpile(e)}).join(", ")+"]"}}}});h.addGrammarElement("blockLiteral",function(e,r){if(r.matchOpToken("\\")){var t=[];var n=r.matchTokenType("IDENTIFIER");if(n){t.push(n);while(r.matchOpToken(",")){t.push(r.requireTokenType("IDENTIFIER"))}}r.requireOpToken("-");r.requireOpToken(">");var a=e.parseElement("expression",r);if(a==null){e.raiseParseError(r,"Expected an expression")}return{type:"blockLiteral",args:t,expr:a,transpile:function(){return"function("+t.map(function(e){return e.value}).join(", ")+"){ return "+e.transpile(a)+" }"}}}});h.addGrammarElement("leaf",function(e,r){return e.parseAnyOf(["parenthesized","boolean","null","string","number","idRef","classRef","symbol","propertyRef","objectLiteral","arrayLiteral","blockLiteral"],r)});h.addGrammarElement("propertyAccess",function(e,r,t){if(r.matchOpToken(".")){var n=r.requireTokenType("IDENTIFIER");var a={type:"propertyAccess",root:t,prop:n,transpile:function(){return e.transpile(t)+"."+n.value}};return h.parseElement("indirectExpression",r,a)}});h.addGrammarElement("functionCall",function(r,e,t){if(e.matchOpToken("(")){var n=[];do{n.push(r.parseElement("expression",e))}while(e.matchOpToken(","));e.requireOpToken(")");var a={type:"functionCall",root:t,args:n,transpile:function(){return r.transpile(t)+"("+n.map(function(e){return r.transpile(e)}).join(",")+")"}};return h.parseElement("indirectExpression",e,a)}});h.addGrammarElement("indirectExpression",function(e,r,t){var n=e.parseElement("propertyAccess",r,t);if(n){return n}var a=e.parseElement("functionCall",r,t);if(a){return a}return t});h.addGrammarElement("primaryExpression",function(e,r){var t=e.parseElement("leaf",r);if(t){return e.parseElement("indirectExpression",r,t)}e.raiseParseError(r,"Unexpected value: "+r.currentToken().value)});h.addGrammarElement("postfixExpression",function(e,r){var t=e.parseElement("primaryExpression",r);if(r.matchOpToken(":")){var n=r.requireTokenType("IDENTIFIER");var a=!r.matchOpToken("!");return{type:"typeCheck",typeName:n,root:t,nullOk:a,transpile:function(){return"_hyperscript.runtime.typeCheck("+e.transpile(t)+", '"+n.value+"', "+a+")"}}}else{return t}});h.addGrammarElement("logicalNot",function(e,r){if(r.matchToken("not")){var t=e.parseElement("unaryExpression",r);return{type:"logicalNot",root:t,transpile:function(){return"!"+e.transpile(t)}}}});h.addGrammarElement("negativeNumber",function(e,r){if(r.matchOpToken("-")){var t=e.parseElement("unaryExpression",r);return{type:"negativeNumber",root:t,transpile:function(){return"-"+e.transpile(t)}}}});h.addGrammarElement("unaryExpression",function(e,r){return e.parseAnyOf(["logicalNot","negativeNumber","postfixExpression"],r)});h.addGrammarElement("mathOperator",function(e,r){var t=e.parseElement("unaryExpression",r);var n,a=null;n=r.matchAnyOpToken("+","-","*","/","%");while(n){a=a||n;if(a.value!==n.value){e.raiseParseError(r,"You must parenthesize math operations with different operators")}var i=e.parseElement("unaryExpression",r);t={type:"mathOperator",operator:n.value,lhs:t,rhs:i,transpile:function(){return e.transpile(this.lhs)+" "+this.operator+" "+e.transpile(this.rhs)}};n=r.matchAnyOpToken("+","-","*","/","%")}return t});h.addGrammarElement("mathExpression",function(e,r){return e.parseAnyOf(["mathOperator","unaryExpression"],r)});h.addGrammarElement("comparisonOperator",function(e,r){var t=e.parseElement("mathExpression",r);var n,a=null;n=r.matchAnyOpToken("<",">","<=",">=","==","===");while(n){a=a||n;if(a.value!==n.value){e.raiseParseError(r,"You must parenthesize comparison operations with different operators")}var i=e.parseElement("mathExpression",r);t={type:"comparisonOperator",operator:n.value,lhs:t,rhs:i,transpile:function(){return e.transpile(this.lhs)+" "+this.operator+" "+e.transpile(this.rhs)}};n=r.matchAnyOpToken("<",">","<=",">=","==","===")}return t});h.addGrammarElement("comparisonExpression",function(e,r){return e.parseAnyOf(["comparisonOperator","mathExpression"],r)});h.addGrammarElement("logicalOperator",function(e,r){var t=e.parseElement("comparisonExpression",r);var n,a=null;n=r.matchToken("and")||r.matchToken("or");while(n){a=a||n;if(a.value!==n.value){e.raiseParseError(r,"You must parenthesize logical operations with different operators")}var i=e.parseElement("comparisonExpression",r);t={type:"logicalOperator",operator:n.value,lhs:t,rhs:i,transpile:function(){return e.transpile(this.lhs)+" "+(this.operator==="and"?" && ":" || ")+" "+e.transpile(this.rhs)}};n=r.matchToken("and")||r.matchToken("or")}return t});h.addGrammarElement("logicalExpression",function(e,r){return e.parseAnyOf(["logicalOperator","mathExpression"],r)});h.addGrammarElement("expression",function(e,r){return e.parseElement("logicalExpression",r)});h.addGrammarElement("target",function(r,e){var t=r.parseAnyOf(["symbol","classRef","idRef"],e);if(t==null){r.raiseParseError(e,"Expected a valid target expression")}return{type:"target",value:t,transpile:function(e){if(t.type==="classRef"){return r.transpile(t)}else if(t.type==="idRef"){return"["+r.transpile(t)+"]"}else{return"["+r.transpile(t)+"]"}}}});h.addGrammarElement("command",function(e,r){return e.parseAnyOf(["onCmd","addCmd","removeCmd","toggleCmd","waitCmd","sendCmd","takeCmd","logCmd","callCmd","putCmd","ifCmd","ajaxCmd"],r)});h.addGrammarElement("commandList",function(e,r){var t=e.parseElement("command",r);if(t){r.matchToken("then");t.next=e.parseElement("commandList",r);return t}});h.addGrammarElement("hyperscript",function(r,e){var t=[];do{t.push(r.parseElement("eventListener",e))}while(e.matchToken("end")&&e.hasMore());if(e.hasMore()){r.raiseParseError(e)}return{type:"hyperscript",eventListeners:t,transpile:function(){return"(function(){\n"+"var eventListeners = []\n"+t.map(function(e){return"eventListeners.push("+r.transpile(e)+");\n"})+"      function applyEventListenersTo(elt) { _hyperscript.runtime.applyEventListeners(this, elt) }"+"      return {eventListeners:eventListeners, applyEventListenersTo:applyEventListenersTo}\n"+"})()"}}});h.addGrammarElement("eventListener",function(e,r){r.requireToken("on");var t=e.parseElement("dotPath",r);if(t==null){e.raiseParseError(r,"Expected event name")}if(r.matchToken("from")){var n=e.parseElement("target",r);if(n==null){e.raiseParseError(r,"Expected target value")}}else{var n=e.parseElement("implicitMeTarget",r)}var a=e.parseElement("commandList",r);var i={type:"eventListener",on:t,from:n,start:a,transpile:function(){return"(function(me){"+"var my = me;\n"+"_hyperscript.runtime.forEach( "+e.transpile(n)+", function(target){\n"+"  target.addEventListener('"+e.transpile(t)+"', function(event){\n"+e.transpile(a)+"  })\n"+"})\n"+"})"}};return i});h.addGrammarElement("addCmd",function(e,r){if(r.matchToken("add")){var t=e.parseElement("classRef",r);var n=null;if(t==null){n=e.parseElement("attributeRef",r);if(n==null){e.raiseParseError(r,"Expected either a class reference or attribute expression")}}if(r.matchToken("to")){var a=e.parseElement("target",r)}else{var a=e.parseElement("implicitMeTarget")}return{type:"addCmd",classRef:t,attributeRef:n,to:a,transpile:function(){if(this.classRef){return"_hyperscript.runtime.forEach( "+e.transpile(a)+", function (target) {"+"  target.classList.add('"+t.className()+"')"+"})"}else{return"_hyperscript.runtime.forEach( "+e.transpile(a)+", function (target) {"+"  target.setAttribute('"+n.name+"', "+e.transpile(n)+".value)"+"})"}}}}});h.addGrammarElement("removeCmd",function(e,r){if(r.matchToken("remove")){var t=e.parseElement("classRef",r);var n=null;var a=null;if(t==null){n=e.parseElement("attributeRef",r);if(n==null){a=e.parseElement("expression",r);if(a==null){e.raiseParseError(r,"Expected either a class reference, attribute expression or value expression")}}}if(r.matchToken("from")){var i=e.parseElement("target",r)}else{var i=e.parseElement("implicitMeTarget")}return{type:"removeCmd",classRef:t,attributeRef:n,elementExpr:a,from:i,transpile:function(){if(this.elementExpr){return"_hyperscript.runtime.forEach( "+e.transpile(a)+", function (target) {"+"  target.parentElement.removeChild(target)"+"})"}else{if(this.classRef){return"_hyperscript.runtime.forEach( "+e.transpile(i)+", function (target) {"+"  target.classList.remove('"+t.className()+"')"+"})"}else{return"_hyperscript.runtime.forEach( "+e.transpile(i)+", function (target) {"+"  target.removeAttribute('"+n.name+"')"+"})"}}}}}});h.addGrammarElement("toggleCmd",function(e,r){if(r.matchToken("toggle")){var t=e.parseElement("classRef",r);var n=null;if(t==null){n=e.parseElement("attributeRef",r);if(n==null){e.raiseParseError(r,"Expected either a class reference or attribute expression")}}if(r.matchToken("on")){var a=e.parseElement("target",r)}else{var a=e.parseElement("implicitMeTarget")}return{type:"toggleCmd",classRef:t,attributeRef:n,on:a,transpile:function(){if(this.classRef){return"_hyperscript.runtime.forEach( "+e.transpile(a)+", function (target) {"+"  target.classList.toggle('"+t.className()+"')"+"})"}else{return"_hyperscript.runtime.forEach( "+e.transpile(a)+", function (target) {"+"  if(target.hasAttribute('"+n.name+"')) {\n"+"    target.removeAttribute('"+n.name+"');\n"+"  } else { \n"+"    target.setAttribute('"+n.name+"', "+e.transpile(n)+".value)"+"  }"+"})"}}}}});h.addGrammarElement("waitCmd",function(r,e){if(e.matchToken("wait")){var t=r.parseElement("millisecondLiteral",e);return{type:"waitCmd",time:t,transpile:function(){var e=this.next;delete this.next;return"setTimeout(function () { "+r.transpile(e)+" }, "+r.transpile(this.time)+")"}}}});h.addGrammarElement("dotPath",function(e,r){var t=h.parseElement("symbol",r);var n=[];if(t){while(r.matchOpToken(".")){n.push(r.requireTokenType("IDENTIFIER"))}return{type:"dotPath",path:n,transpile:function(){return e.transpile(t)+n.join(".")}}}});h.addGrammarElement("sendCmd",function(e,r){if(r.matchToken("send")){var t=e.parseElement("dotPath",r);var n=e.parseElement("objectLiteral",r);if(r.matchToken("to")){var a=e.parseElement("target",r)}else{var a=e.parseElement("implicitMeTarget")}return{type:"sendCmd",eventName:t,details:n,to:a,transpile:function(){return"_hyperscript.runtime.forEach( "+e.transpile(a)+", function (target) {"+"  _hyperscript.runtime.triggerEvent(target, '"+e.transpile(t)+"',"+e.transpile(n,"{}")+")"+"})"}}}});h.addGrammarElement("takeCmd",function(r,e){if(e.matchToken("take")){var t=e.requireTokenType(e,"CLASS_REF");if(e.matchToken("from")){var n=r.parseElement("target",e)}else{var n=r.parseElement("implicitAllTarget")}return{type:"takeCmd",classRef:t,from:n,transpile:function(){var e=this.classRef.value.substr(1);return"  _hyperscript.runtime.forEach("+r.transpile(n)+", function (target) { target.classList.remove('"+e+"') }); "+"me.classList.add('"+e+"');"}}}});h.addGrammarElement("logCmd",function(r,e){if(e.matchToken("log")){var t=[r.parseElement("expression",e)];while(e.matchOpToken(",")){t.push(r.parseElement("expression",e))}if(e.matchToken("with")){var n=r.parseElement("expression",e)}return{type:"logCmd",exprs:t,withExpr:n,transpile:function(){if(n){return r.transpile(n)+"("+t.map(function(e){return r.transpile(e)}).join(", ")+")"}else{return"console.log("+t.map(function(e){return r.transpile(e)}).join(", ")+")"}}}}});h.addGrammarElement("callCmd",function(e,r){if(r.matchToken("call")){return{type:"callCmd",expr:e.parseElement("expression",r),transpile:function(){return"var it = "+e.transpile(this.expr)}}}});h.addGrammarElement("putCmd",function(r,e){if(e.matchToken("put")){var t=r.parseElement("expression",e);var n=e.matchToken("into")||e.matchToken("before")||e.matchToken("afterbegin")||e.matchToken("beforeend")||e.matchToken("after");if(n==null){r.raiseParseError(e,"Expected one of 'into', 'before', 'afterbegin', 'beforeend', 'after'")}var a=r.parseElement("target",e);var i=[];while(e.matchOpToken(".")){i.push(e.requireTokenType("IDENTIFIER").value)}var s=i.length===0&&n.value==="into";var o=s&&a.value.type==="symbol";if(s&&!o){r.raiseParseError(e,"Can only put directly into symbols, not references")}return{type:"putCmd",target:a,propPath:i,op:n.value,symbolWrite:o,value:t,transpile:function(){if(this.symbolWrite){return"var "+a.value.name+" = "+r.transpile(t)}else{var e=i.length===0?"":"."+i.join(".");if(this.op==="into"){return"_hyperscript.runtime.forEach( "+r.transpile(a)+", function (target) {"+"  target"+e+"="+r.transpile(t)+"})"}else if(this.op==="before"){return"_hyperscript.runtime.forEach( "+r.transpile(a)+", function (target) {"+"  target"+e+".insertAdjacentHTML('beforebegin', "+r.transpile(t)+")"+"})"}else if(this.op==="afterbegin"){return"_hyperscript.runtime.forEach( "+r.transpile(a)+", function (target) {"+"  target"+e+".insertAdjacentHTML('afterbegin', "+r.transpile(t)+")"+"})"}else if(this.op==="beforeend"){return"_hyperscript.runtime.forEach( "+r.transpile(a)+", function (target) {"+"  target"+e+".insertAdjacentHTML('beforeend', "+r.transpile(t)+")"+"})"}else if(this.op==="after"){return"_hyperscript.runtime.forEach( "+r.transpile(a)+", function (target) {"+"  target"+e+".insertAdjacentHTML('afterend', "+r.transpile(t)+")"+"})"}}}}}});h.addGrammarElement("ifCmd",function(e,r){if(r.matchToken("if")){var t=e.parseElement("expression",r);var n=e.parseElement("commandList",r);if(r.matchToken("else")){var a=e.parseElement("commandList",r)}if(r.hasMore()){r.requireToken("end")}return{type:"ifCmd",expr:t,trueBranch:n,falseBranch:a,transpile:function(){return"if("+e.transpile(t)+"){"+""+e.transpile(n)+"}"+"   else {"+e.transpile(a,"")+"}"}}}});h.addGrammarElement("ajaxCmd",function(r,e){if(e.matchToken("ajax")){var t=e.matchToken("GET")||e.matchToken("POST");if(t==null){r.raiseParseError(e,"Requires either GET or POST")}if(t.value==="GET"){e.requireToken("from")}else{e.requireToken("to")}var n=r.parseElement("string",e);if(n==null){r.raiseParseError(e,"Requires a URL")}if(e.matchToken("with")){e.requireToken("body");var a=r.parseElement("expression",e);if(a==null){r.raiseParseError(e,"Requires a URL")}}return{type:"requestCommand",method:t,transpile:function(){var e=this.next;delete this.next;return"_hyperscript.runtime.ajax('"+t.value+"', "+r.transpile(n)+", "+"function(it){ "+r.transpile(e)+" },"+r.transpile(a,"null")+")"}}}});function e(e){if(e){t.setScriptAttrs(e)}var r=function(){var e=document.querySelectorAll(t.getScriptSelector());t.forEach(e,function(e){n(e)})};if(document.readyState!=="loading"){r()}else{document.addEventListener("DOMContentLoaded",r)}return true}function n(e){t.initElement(e)}function r(e){return t.evaluate(e)}return{lexer:v,parser:h,runtime:t,evaluate:r,init:n,start:e}}()});