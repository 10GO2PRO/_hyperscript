(function(){function o(e,t){for(var r in t){if(t.hasOwnProperty(r)){e[r]=t[r]}}return e}_hyperscript.addCommand("settle",function(e,o,t){if(t.matchToken("settle")){if(!e.commandBoundary(t.currentToken())){var r=e.requireElement("expression",t)}else{var r=e.requireElement("implicitMeTarget")}var s={type:"settleCmd",args:[r],op:function(e,t){var r=null;var n=false;var i=false;var a=new Promise(function(e){r=e});t.addEventListener("transitionstart",function(){i=true},{once:true});setTimeout(function(){if(!i&&!n){r(o.findNext(s,e))}},500);t.addEventListener("transitionend",function(){if(!n){r(o.findNext(s,e))}},{once:true});return a},execute:function(e){return o.unifiedExec(this,e)}};return s}});_hyperscript.addCommand("add",function(e,n,t){if(t.matchToken("add")){var r=e.parseElement("classRef",t);var i=null;if(r==null){i=e.parseElement("attributeRef",t);if(i==null){e.raiseParseError(t,"Expected either a class reference or attribute expression")}}if(t.matchToken("to")){var a=e.requireElement("target",t)}else{var a=e.parseElement("implicitMeTarget")}if(r){var o={classRef:r,attributeRef:i,to:a,args:[a],op:function(e,t){n.forEach(t,function(e){e.classList.add(r.className())});return n.findNext(this,e)}}}else{var o={type:"addCmd",classRef:r,attributeRef:i,to:a,args:[a,i],op:function(e,t,r){n.forEach(t,function(e){e.setAttribute(r.name,r.value)});return n.findNext(o,e)},execute:function(e){return n.unifiedExec(this,e)}}}return o}});_hyperscript.addCommand("remove",function(e,r,t){if(t.matchToken("remove")){var n=e.parseElement("classRef",t);var i=null;var a=null;if(n==null){i=e.parseElement("attributeRef",t);if(i==null){a=e.parseElement("expression",t);if(a==null){e.raiseParseError(t,"Expected either a class reference, attribute expression or value expression")}}}if(t.matchToken("from")){var o=e.requireElement("target",t)}else{var o=e.requireElement("implicitMeTarget")}if(a){var s={classRef:n,attributeRef:i,elementExpr:a,from:o,args:[a],op:function(e,t){r.forEach(t,function(e){e.parentElement.removeChild(e)});return r.findNext(this,e)}}}else{var s={classRef:n,attributeRef:i,elementExpr:a,from:o,args:[o],op:function(e,t){if(this.classRef){r.forEach(t,function(e){e.classList.remove(n.className())})}else{r.forEach(t,function(e){e.removeAttribute(i.name)})}return r.findNext(this,e)}}}return s}});_hyperscript.addCommand("toggle",function(e,s,t){if(t.matchToken("toggle")){var r=e.parseElement("classRef",t);var n=null;if(r==null){n=e.parseElement("attributeRef",t);if(n==null){e.raiseParseError(t,"Expected either a class reference or attribute expression")}}if(t.matchToken("on")){var i=e.requireElement("target",t)}else{var i=e.requireElement("implicitMeTarget")}if(t.matchToken("for")){var a=e.requireElement("timeExpression",t)}else if(t.matchToken("until")){var o=e.requireElement("dotOrColonPath",t,"Expected event name");if(t.matchToken("from")){var l=e.requireElement("expression",t)}}var f={classRef:r,attributeRef:n,on:i,time:a,evt:o,from:l,toggle:function(e,t){if(this.classRef){s.forEach(e,function(e){e.classList.toggle(r.className())})}else{s.forEach(e,function(e){if(e.hasAttribute(n.name)){e.removeAttribute(n.name)}else{e.setAttribute(n.name,t)}})}},args:[i,n?n.value:null,a,o,l],op:function(r,n,i,t,a,o){if(t){return new Promise(function(e){f.toggle(n,i);setTimeout(function(){f.toggle(n,i);e(s.findNext(f,r))},t)})}else if(a){return new Promise(function(e){var t=o||r.me;t.addEventListener(a,function(){f.toggle(n,i);e(s.findNext(f,r))},{once:true});f.toggle(n,i)})}else{this.toggle(n,i);return s.findNext(f,r)}}};return f}});var s={display:function(e,t,r){if(r){t.style.display=r}else if(e==="hide"){t.style.display="none"}else{t.style.display="block"}},visibility:function(e,t,r){if(r){t.style.visibility=r}else if(e==="hide"){t.style.visibility="hidden"}else{t.style.visibility="visible"}},opacity:function(e,t,r){if(r){t.style.opacity=r}else if(e==="hide"){t.style.opacity="0"}else{t.style.opacity="1"}}};var l=function(e,t,r){var n;var i=r.currentToken();if(i.value==="with"||e.commandBoundary(i)){n=e.parseElement("implicitMeTarget",r)}else{n=e.parseElement("target",r)}return n};var f=function(e,t,r){var n=_hyperscript.config.defaultHideShowStrategy;var i=s;if(_hyperscript.config.hideShowStrategies){i=o(i,_hyperscript.config.hideShowStrategies)}r=r||n||"display";var a=i[r];if(a==null){e.raiseParseError(t,"Unknown show/hide strategy : "+r)}return a};_hyperscript.addCommand("hide",function(e,r,t){if(t.matchToken("hide")){var n=l(e,r,t);var i=null;if(t.matchToken("with")){i=t.requireTokenType("IDENTIFIER").value}var a=f(e,t,i);return{target:n,args:[n],op:function(e,t){r.forEach(t,function(e){a("hide",e)});return r.findNext(this,e)}}}});_hyperscript.addCommand("show",function(e,r,t){if(t.matchToken("show")){var n=l(e,r,t);var i=null;if(t.matchToken("with")){i=t.requireTokenType("IDENTIFIER").value}var a=null;if(t.matchOpToken(":")){var o=t.consumeUntilWhitespace();t.matchTokenType("WHITESPACE");a=o.map(function(e){return e.value}).join("")}var s=f(e,t,i);return{target:n,args:[n],op:function(e,t){r.forEach(t,function(e){s("show",e,a)});return r.findNext(this,e)}}}});_hyperscript.addCommand("trigger",function(e,n,t){if(t.matchToken("trigger")){var r=e.requireElement("dotOrColonPath",t);var i=e.parseElement("namedArgumentList",t);var a={eventName:r,details:i,args:[r,i],op:function(e,t,r){n.triggerEvent(e.me,t,r?r:{});return n.findNext(a,e)}};return a}});_hyperscript.addCommand("take",function(e,i,t){if(t.matchToken("take")){var r=t.requireTokenType(t,"CLASS_REF");if(t.matchToken("from")){var n=e.requireElement("target",t)}else{var n=e.requireElement("implicitAllTarget")}if(t.matchToken("for")){var a=e.requireElement("target",t)}else{var a=e.requireElement("implicitMeTarget")}var o={classRef:r,from:n,forElt:a,args:[n,a],op:function(e,t,r){var n=this.classRef.value.substr(1);i.forEach(t,function(e){e.classList.remove(n)});i.forEach(r,function(e){e.classList.add(n)});return i.findNext(this,e)}};return o}});_hyperscript.addCommand("put",function(e,n,t){if(t.matchToken("put")){var r=e.requireElement("expression",t);var i=t.matchToken("into")||t.matchToken("before")||t.matchToken("after");if(i==null&&t.matchToken("at")){i=t.matchToken("start")||t.matchToken("end");t.requireToken("of")}if(i==null){e.raiseParseError(t,"Expected one of 'into', 'before', 'at start of', 'at end of', 'after'")}var a=e.requireElement("target",t);var o=i.value;var s=a.type==="symbol"&&o==="into";if(a.type!=="symbol"&&o==="into"&&a.root==null){e.raiseParseError(t,"Can only put directly into symbols, not references")}var l=null;var f=null;if(s){}else if(o==="into"){f=a.prop.value;l=a.root}else{l=a}var u={target:a,operation:o,symbolWrite:s,value:r,args:[l,r],op:function(e,t,r){if(s){e[a.name]=r}else{if(o==="into"){n.forEach(t,function(e){e[f]=r})}else if(o==="before"){n.forEach(t,function(e){e.insertAdjacentHTML("beforebegin",r)})}else if(o==="start"){n.forEach(t,function(e){e.insertAdjacentHTML("afterbegin",r)})}else if(o==="end"){n.forEach(t,function(e){e.insertAdjacentHTML("beforeend",r)})}else if(o==="after"){n.forEach(t,function(e){e.insertAdjacentHTML("afterend",r)})}}return n.findNext(this,e)}};return u}});_hyperscript.addCommand("transition",function(e,h,t){if(t.matchToken("transition")){if(t.matchToken("element")||t.matchToken("elements")){var r=e.parseElement("expression",t)}else{var r=e.parseElement("implicitMeTarget")}var p=[];var n=[];var i=[];while(t.hasMore()&&!e.commandBoundary(t.currentToken())&&t.currentToken().value!=="using"){p.push(t.requireTokenType("IDENTIFIER").value);if(t.matchToken("from")){n.push(e.requireElement("stringLike",t))}else{n.push(null)}t.requireToken("to");i.push(e.requireElement("stringLike",t))}if(t.matchToken("using")){var a=e.requireElement("expression",t)}var o={to:i,args:[r,n,i,a],op:function(e,t,m,v,d){var r=[];h.forEach(t,function(c){var e=new Promise(function(a,e){var o=c.style.transition;c.style.transition=d||_hyperscript.config.defaultTransition;var s=h.getInternalData(c);var t=getComputedStyle(c);var r={};for(var n=0;n<t.length;n++){var i=t[n];var l=t[i];r[i]=l}if(!s.initalStyles){s.initalStyles=r}for(var n=0;n<p.length;n++){var f=p[n];var u=m[n];if(u=="computed"||u==null){c.style[f]=r[f]}else{c.style[f]=u}}setTimeout(function(){var e=[];for(var t=0;t<p.length;t++){var r=p[t];var n=v[t];if(n=="initial"){var i=s.initalStyles[r];c.style[r]=i}else{c.style[r]=n}}c.addEventListener("transitionend",function(){c.style.transition=o;a()},{once:true})},5)});r.push(e)});return Promise.all(r).then(function(){return h.findNext(o,e)})}};return o}})})();