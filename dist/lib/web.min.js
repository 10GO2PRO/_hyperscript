(function(){function s(e,t){for(var r in t){if(t.hasOwnProperty(r)){e[r]=t[r]}}return e}_hyperscript.addCommand("settle",function(e,s,t){if(t.matchToken("settle")){if(!e.commandBoundary(t.currentToken())){var r=e.requireElement("expression",t)}else{var r=e.requireElement("implicitMeTarget")}var o={type:"settleCmd",args:[r],op:function(e,t){var r=null;var n=false;var i=false;var a=new Promise(function(e){r=e});t.addEventListener("transitionstart",function(){i=true},{once:true});setTimeout(function(){if(!i&&!n){r(s.findNext(o,e))}},500);t.addEventListener("transitionend",function(){if(!n){r(s.findNext(o,e))}},{once:true});return a},execute:function(e){return s.unifiedExec(this,e)}};return o}});_hyperscript.addCommand("add",function(e,n,t){if(t.matchToken("add")){var r=e.parseElement("classRef",t);var i=null;if(r==null){i=e.parseElement("attributeRef",t);if(i==null){e.raiseParseError(t,"Expected either a class reference or attribute expression")}}if(t.matchToken("to")){var a=e.requireElement("target",t)}else{var a=e.parseElement("implicitMeTarget")}if(r){var s={classRef:r,attributeRef:i,to:a,args:[a],op:function(e,t){n.forEach(t,function(e){e.classList.add(r.className())});return n.findNext(this,e)}}}else{var s={type:"addCmd",classRef:r,attributeRef:i,to:a,args:[a,i],op:function(e,t,r){n.forEach(t,function(e){e.setAttribute(r.name,r.value)});return n.findNext(s,e)},execute:function(e){return n.unifiedExec(this,e)}}}return s}});_hyperscript.addCommand("remove",function(e,r,t){if(t.matchToken("remove")){var n=e.parseElement("classRef",t);var i=null;var a=null;if(n==null){i=e.parseElement("attributeRef",t);if(i==null){a=e.parseElement("expression",t);if(a==null){e.raiseParseError(t,"Expected either a class reference, attribute expression or value expression")}}}if(t.matchToken("from")){var s=e.requireElement("target",t)}else{var s=e.requireElement("implicitMeTarget")}if(a){var o={classRef:n,attributeRef:i,elementExpr:a,from:s,args:[a],op:function(e,t){r.forEach(t,function(e){e.parentElement.removeChild(e)});return r.findNext(this,e)}}}else{var o={classRef:n,attributeRef:i,elementExpr:a,from:s,args:[s],op:function(e,t){if(this.classRef){r.forEach(t,function(e){e.classList.remove(n.className())})}else{r.forEach(t,function(e){e.removeAttribute(i.name)})}return r.findNext(this,e)}}}return o}});_hyperscript.addCommand("toggle",function(e,o,t){if(t.matchToken("toggle")){if(t.matchToken("between")){var r=true;var n=e.parseElement("classRef",t);t.requireToken("and");var i=e.requireElement("classRef",t)}else{var n=e.parseElement("classRef",t);var a=null;if(n==null){a=e.parseElement("attributeRef",t);if(a==null){e.raiseParseError(t,"Expected either a class reference or attribute expression")}}}if(t.matchToken("on")){var s=e.requireElement("target",t)}else{var s=e.requireElement("implicitMeTarget")}if(t.matchToken("for")){var l=e.requireElement("timeExpression",t)}else if(t.matchToken("until")){var f=e.requireElement("dotOrColonPath",t,"Expected event name");if(t.matchToken("from")){var c=e.requireElement("expression",t)}}var u={classRef:n,classRef2:i,attributeRef:a,on:s,time:l,evt:f,from:c,toggle:function(e,t){if(this.classRef){if(r){o.forEach(e,function(e){if(e.classList.contains(n.className())){e.classList.remove(n.className());e.classList.add(i.className())}else{e.classList.add(n.className());e.classList.remove(i.className())}})}else{o.forEach(e,function(e){e.classList.toggle(n.className())})}}else{o.forEach(e,function(e){if(e.hasAttribute(a.name)){e.removeAttribute(a.name)}else{e.setAttribute(a.name,t)}})}},args:[s,a?a.value:null,l,f,c],op:function(r,n,i,t,a,s){if(t){return new Promise(function(e){u.toggle(n,i);setTimeout(function(){u.toggle(n,i);e(o.findNext(u,r))},t)})}else if(a){return new Promise(function(e){var t=s||r.me;t.addEventListener(a,function(){u.toggle(n,i);e(o.findNext(u,r))},{once:true});u.toggle(n,i)})}else{this.toggle(n,i);return o.findNext(u,r)}}};return u}});var o={display:function(e,t,r){if(r){t.style.display=r}else if(e==="hide"){t.style.display="none"}else{t.style.display="block"}},visibility:function(e,t,r){if(r){t.style.visibility=r}else if(e==="hide"){t.style.visibility="hidden"}else{t.style.visibility="visible"}},opacity:function(e,t,r){if(r){t.style.opacity=r}else if(e==="hide"){t.style.opacity="0"}else{t.style.opacity="1"}}};var l=function(e,t,r){var n;var i=r.currentToken();if(i.value==="with"||e.commandBoundary(i)){n=e.parseElement("implicitMeTarget",r)}else{n=e.parseElement("target",r)}return n};var f=function(e,t,r){var n=_hyperscript.config.defaultHideShowStrategy;var i=o;if(_hyperscript.config.hideShowStrategies){i=s(i,_hyperscript.config.hideShowStrategies)}r=r||n||"display";var a=i[r];if(a==null){e.raiseParseError(t,"Unknown show/hide strategy : "+r)}return a};_hyperscript.addCommand("hide",function(e,r,t){if(t.matchToken("hide")){var n=l(e,r,t);var i=null;if(t.matchToken("with")){i=t.requireTokenType("IDENTIFIER").value}var a=f(e,t,i);return{target:n,args:[n],op:function(e,t){r.forEach(t,function(e){a("hide",e)});return r.findNext(this,e)}}}});_hyperscript.addCommand("show",function(e,r,t){if(t.matchToken("show")){var n=l(e,r,t);var i=null;if(t.matchToken("with")){i=t.requireTokenType("IDENTIFIER").value}var a=null;if(t.matchOpToken(":")){var s=t.consumeUntilWhitespace();t.matchTokenType("WHITESPACE");a=s.map(function(e){return e.value}).join("")}var o=f(e,t,i);return{target:n,args:[n],op:function(e,t){r.forEach(t,function(e){o("show",e,a)});return r.findNext(this,e)}}}});_hyperscript.addCommand("trigger",function(e,n,t){if(t.matchToken("trigger")){var r=e.requireElement("dotOrColonPath",t);var i=e.parseElement("namedArgumentList",t);var a={eventName:r,details:i,args:[r,i],op:function(e,t,r){n.triggerEvent(e.me,t,r?r:{});return n.findNext(a,e)}};return a}});_hyperscript.addCommand("take",function(e,i,t){if(t.matchToken("take")){var r=t.requireTokenType(t,"CLASS_REF");if(t.matchToken("from")){var n=e.requireElement("target",t)}else{var n=e.requireElement("implicitAllTarget")}if(t.matchToken("for")){var a=e.requireElement("target",t)}else{var a=e.requireElement("implicitMeTarget")}var s={classRef:r,from:n,forElt:a,args:[n,a],op:function(e,t,r){var n=this.classRef.value.substr(1);i.forEach(t,function(e){e.classList.remove(n)});i.forEach(r,function(e){e.classList.add(n)});return i.findNext(this,e)}};return s}});function u(e,t,r){if(t){var n=e[t]}else{var n=e}if(n instanceof Element||n instanceof HTMLDocument){n.innerHTML=r}else{if(t){e[t]=r}else{throw"Don't know how to put a value into "+typeof e}}}_hyperscript.addCommand("put",function(e,n,t){if(t.matchToken("put")){var r=e.requireElement("expression",t);var i=t.matchToken("into")||t.matchToken("before")||t.matchToken("after");if(i==null&&t.matchToken("at")){i=t.matchToken("start")||t.matchToken("end");t.requireToken("of")}if(i==null){e.raiseParseError(t,"Expected one of 'into', 'before', 'at start of', 'at end of', 'after'")}var a=e.requireElement("target",t);var s=i.value;var o=false;var l=null;var f=null;if(a.type==="propertyAccess"&&s==="into"){f=a.prop.value;l=a.root}else if(a.type==="symbol"&&s==="into"){o=true;f=a.name}else{l=a}var c={target:a,operation:s,symbolWrite:o,value:r,args:[l,r],op:function(e,t,r){if(o){u(e,f,r);e[a.name]=r}else{if(s==="into"){n.forEach(t,function(e){u(e,f,r)})}else if(s==="before"){n.forEach(t,function(e){e.insertAdjacentHTML("beforebegin",r)})}else if(s==="start"){n.forEach(t,function(e){e.insertAdjacentHTML("afterbegin",r)})}else if(s==="end"){n.forEach(t,function(e){e.insertAdjacentHTML("beforeend",r)})}else if(s==="after"){n.forEach(t,function(e){e.insertAdjacentHTML("afterend",r)})}}return n.findNext(this,e)}};return c}});_hyperscript.addCommand("transition",function(e,h,t){if(t.matchToken("transition")){if(t.matchToken("element")||t.matchToken("elements")){var r=e.parseElement("expression",t)}else{var r=e.parseElement("implicitMeTarget")}var p=[];var n=[];var i=[];var a=t.currentToken();while(!e.commandBoundary(a)&&a.value!=="using"){p.push(t.requireTokenType("IDENTIFIER").value);if(t.matchToken("from")){n.push(e.requireElement("stringLike",t))}else{n.push(null)}t.requireToken("to");i.push(e.requireElement("stringLike",t));a=t.currentToken()}if(t.matchToken("using")){var s=e.requireElement("expression",t)}var o={to:i,args:[r,n,i,s],op:function(e,t,m,v,d){var r=[];h.forEach(t,function(u){var e=new Promise(function(a,e){var s=u.style.transition;u.style.transition=d||_hyperscript.config.defaultTransition;var o=h.getInternalData(u);var t=getComputedStyle(u);var r={};for(var n=0;n<t.length;n++){var i=t[n];var l=t[i];r[i]=l}if(!o.initalStyles){o.initalStyles=r}for(var n=0;n<p.length;n++){var f=p[n];var c=m[n];if(c=="computed"||c==null){u.style[f]=r[f]}else{u.style[f]=c}}setTimeout(function(){var e=[];for(var t=0;t<p.length;t++){var r=p[t];var n=v[t];if(n=="initial"){var i=o.initalStyles[r];u.style[r]=i}else{u.style[r]=n}}u.addEventListener("transitionend",function(){u.style.transition=s;a()},{once:true})},5)});r.push(e)});return Promise.all(r).then(function(){return h.findNext(o,e)})}};return o}})})();